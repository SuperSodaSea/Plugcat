create_ip -module_name GTWizard0 -vendor xilinx.com -library ip -name gtwizard_ultrascale -version 1.7

set GTWIZARD0_PROPERTIES {}

set GTWIZARD0_PROPERTIES [concat $GTWIZARD0_PROPERTIES {
    CONFIG.preset GTY-HDMI

    CONFIG.TX_USER_DATA_WIDTH 40
    CONFIG.TX_INT_DATA_WIDTH 40

    CONFIG.RX_USER_DATA_WIDTH 40
    CONFIG.RX_INT_DATA_WIDTH 40

    CONFIG.FREERUN_FREQUENCY 10.0

    CONFIG.CHANNEL_ENABLE { X1Y55 X1Y54 X1Y53 X1Y52 }
    CONFIG.TX_MASTER_CHANNEL X1Y53
    CONFIG.RX_MASTER_CHANNEL X1Y53

    CONFIG.LOCATE_TX_USER_CLOCKING CORE
    CONFIG.LOCATE_RX_USER_CLOCKING CORE

    CONFIG.ENABLE_OPTIONAL_PORTS {
        gtrefclk00_in
        gtrefclk01_in

        qpll0outclk_out
        qpll0outrefclk_out
        qpll1outclk_out
        qpll1outrefclk_out
    }
}]

switch "$RESOLUTION@$REFRESH_RATE" {
    "1920x1080@30" {
        set GTWIZARD0_PROPERTIES [concat $GTWIZARD0_PROPERTIES {
            CONFIG.TX_LINE_RATE 0.7425
            CONFIG.TX_PLL_TYPE QPLL0
            CONFIG.TX_QPLL_FRACN_NUMERATOR 12220050
            CONFIG.TX_REFCLK_FREQUENCY 161.1320001

            CONFIG.RX_LINE_RATE 0.7425
            CONFIG.RX_PLL_TYPE QPLL0
            CONFIG.RX_QPLL_FRACN_NUMERATOR 12220050
            CONFIG.RX_REFCLK_FREQUENCY 161.1320001
        }]
    }
    "2560x1440@30" {
        set GTWIZARD0_PROPERTIES [concat $GTWIZARD0_PROPERTIES {
            CONFIG.TX_LINE_RATE 1.21584
            CONFIG.TX_PLL_TYPE QPLL1
            CONFIG.TX_QPLL_FRACN_NUMERATOR 6122311
            CONFIG.TX_REFCLK_FREQUENCY 161.1320001

            CONFIG.RX_LINE_RATE 1.21584
            CONFIG.RX_PLL_TYPE QPLL1
            CONFIG.RX_QPLL_FRACN_NUMERATOR 6122311
            CONFIG.RX_REFCLK_FREQUENCY 161.1320001
        }]
    }
    "1920x1080@60" {
        set GTWIZARD0_PROPERTIES [concat $GTWIZARD0_PROPERTIES {
            CONFIG.TX_LINE_RATE 1.485
            CONFIG.TX_PLL_TYPE QPLL0
            CONFIG.TX_QPLL_FRACN_NUMERATOR 12220050
            CONFIG.TX_REFCLK_FREQUENCY 161.1320001

            CONFIG.RX_LINE_RATE 1.485
            CONFIG.RX_PLL_TYPE QPLL0
            CONFIG.RX_QPLL_FRACN_NUMERATOR 12220050
            CONFIG.RX_REFCLK_FREQUENCY 161.1320001
        }]
    }
    "2560x1440@60" {
        set GTWIZARD0_PROPERTIES [concat $GTWIZARD0_PROPERTIES {
            CONFIG.TX_LINE_RATE 2.43168
            CONFIG.TX_PLL_TYPE QPLL1
            CONFIG.TX_QPLL_FRACN_NUMERATOR 6122311
            CONFIG.TX_REFCLK_FREQUENCY 161.1320001

            CONFIG.RX_LINE_RATE 2.43168
            CONFIG.RX_PLL_TYPE QPLL1
            CONFIG.RX_QPLL_FRACN_NUMERATOR 6122311
            CONFIG.RX_REFCLK_FREQUENCY 161.1320001
        }]
    }
    "1920x1080@120" -
    "3840x2160@30" {
        set GTWIZARD0_PROPERTIES [concat $GTWIZARD0_PROPERTIES {
            CONFIG.TX_LINE_RATE 2.97
            CONFIG.TX_PLL_TYPE QPLL0
            CONFIG.TX_QPLL_FRACN_NUMERATOR 12220050
            CONFIG.TX_REFCLK_FREQUENCY 161.1320001

            CONFIG.RX_LINE_RATE 2.97
            CONFIG.RX_PLL_TYPE QPLL0
            CONFIG.RX_QPLL_FRACN_NUMERATOR 12220050
            CONFIG.RX_REFCLK_FREQUENCY 161.1320001
        }]
    }
    "1920x1080@144" {
        set GTWIZARD0_PROPERTIES [concat $GTWIZARD0_PROPERTIES {
            CONFIG.TX_LINE_RATE 3.564
            CONFIG.TX_PLL_TYPE QPLL0
            CONFIG.TX_QPLL_FRACN_NUMERATOR 3999688
            CONFIG.TX_REFCLK_FREQUENCY 161.132

            CONFIG.RX_LINE_RATE 3.564
            CONFIG.RX_PLL_TYPE QPLL0
            CONFIG.RX_QPLL_FRACN_NUMERATOR 3999688
            CONFIG.RX_REFCLK_FREQUENCY 161.132
        }]
    }
    "2560x1440@120" {
        set GTWIZARD0_PROPERTIES [concat $GTWIZARD0_PROPERTIES {
            CONFIG.TX_LINE_RATE 4.86336
            CONFIG.TX_PLL_TYPE QPLL1
            CONFIG.TX_QPLL_FRACN_NUMERATOR 6122311
            CONFIG.TX_REFCLK_FREQUENCY 161.1320001

            CONFIG.RX_LINE_RATE 4.86336
            CONFIG.RX_PLL_TYPE QPLL1
            CONFIG.RX_QPLL_FRACN_NUMERATOR 6122311
            CONFIG.RX_REFCLK_FREQUENCY 161.1320001
        }]
    }
    "2560x1440@144" {
        set GTWIZARD0_PROPERTIES [concat $GTWIZARD0_PROPERTIES {
            CONFIG.TX_LINE_RATE 5.836032
            CONFIG.TX_PLL_TYPE QPLL0
            CONFIG.TX_QPLL_FRACN_NUMERATOR 7346773
            CONFIG.TX_REFCLK_FREQUENCY 161.1320001

            CONFIG.RX_LINE_RATE 5.836032
            CONFIG.RX_PLL_TYPE QPLL0
            CONFIG.RX_QPLL_FRACN_NUMERATOR 7346773
            CONFIG.RX_REFCLK_FREQUENCY 161.1320001
        }]
    }
    "1920x1080@240" -
    "3840x2160@60" {
        set GTWIZARD0_PROPERTIES [concat $GTWIZARD0_PROPERTIES {
            CONFIG.TX_LINE_RATE 5.94
            CONFIG.TX_PLL_TYPE QPLL0
            CONFIG.TX_QPLL_FRACN_NUMERATOR 12220050
            CONFIG.TX_REFCLK_FREQUENCY 161.1320001

            CONFIG.RX_LINE_RATE 5.94
            CONFIG.RX_PLL_TYPE QPLL0
            CONFIG.RX_QPLL_FRACN_NUMERATOR 12220050
            CONFIG.RX_REFCLK_FREQUENCY 161.1320001
        }]
    }
    default {
        error "Invalid video mode $RESOLUTION@$REFRESH_RATE"
    }
}

set_property -dict $GTWIZARD0_PROPERTIES [get_ips GTWizard0]
